<script>
  // Proje verilerini Jekyll'dan alıp JS'e aktarmak için
  const allProjectsData = {
    {% assign s_global_js = site.data.strings %}
    tr: {
      projects: [
        {% assign base_project_path_tr = '_projects/tr/' %}
        {% assign projects_tr_modal_js = site.projects | where_exp: "item", "item.path contains base_project_path_tr" %}
        {% for p_tr_modal_js in projects_tr_modal_js %}
        {
          id: "{{ p_tr_modal_js.id | slugify }}",
          title: "{{ p_tr_modal_js.title | escape_once }}",
          content: {{ p_tr_modal_js.content | strip_newlines | jsonify }},
          tags: {{ p_tr_modal_js.tags | jsonify }},
          github: "{{ p_tr_modal_js.github_url }}",
          live: "{{ p_tr_modal_js.live_url }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    },
    en: {
      projects: [
        {% assign base_project_path_en = '_projects/en/' %}
        {% assign projects_en_modal_js = site.projects | where_exp: "item", "item.path contains base_project_path_en" %}
        {% for p_en_modal_js in projects_en_modal_js %}
        {
          id: "{{ p_en_modal_js.id | slugify }}",
          title: "{{ p_en_modal_js.title | escape_once }}",
          content: {{ p_en_modal_js.content | strip_newlines | jsonify }},
          tags: {{ p_en_modal_js.tags | jsonify }},
          github: "{{ p_en_modal_js.github_url }}",
          live: "{{ p_en_modal_js.live_url }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }
  };
  
  console.log("MODAL SCRIPTS: allProjectsData object initialized:", JSON.parse(JSON.stringify(allProjectsData)));
  
  const projectModal = document.getElementById('projectModal');
  const modalTitleEl = document.getElementById('modalTitle');
  const modalContentEl = document.getElementById('modalContent');
  const modalTagsEl = document.getElementById('modalTags');
  const modalGithubEl = document.getElementById('modalGithub');
  const modalLiveEl = document.getElementById('modalLive');
  
  console.log("MODAL SCRIPTS: Modal HTML elements obtained:",
      { projectModal, modalTitleEl, modalContentEl, modalTagsEl, modalGithubEl, modalLiveEl }
  );
  
  function openProjectModal(projectId, lang) {
      console.log("MODAL SCRIPTS: openProjectModal function CALLED with projectId:", projectId, " lang:", lang);
  
      if (!projectModal) {
          console.error("MODAL SCRIPTS: ERROR - projectModal element is null. Modal cannot be shown.");
          return;
      }
  
      const currentLangProjectData = allProjectsData[lang];
      console.log("MODAL SCRIPTS: Data for selected language (" + lang + "):", currentLangProjectData);
  
      if (!currentLangProjectData || !currentLangProjectData.projects) {
          console.error("MODAL SCRIPTS: ERROR - Project data for language '" + lang + "' not found or invalid in allProjectsData.");
          projectModal.classList.add('hidden');
          return;
      }
  
      const project = currentLangProjectData.projects.find(p => p.id === projectId);
      console.log("MODAL SCRIPTS: Project found by ID '" + projectId + "':", project);
  
      if (project && modalTitleEl && modalContentEl && modalTagsEl && modalGithubEl && modalLiveEl) {
          console.log("MODAL SCRIPTS: All conditions met. Populating and showing modal.");
          modalTitleEl.textContent = project.title || "Title Not Available";
          modalContentEl.innerHTML = project.content || "<p>Content Not Available.</p>";
  
          modalTagsEl.innerHTML = '';
          if (project.tags && project.tags.length > 0) {
              console.log("MODAL SCRIPTS: Populating tags:", project.tags);
              project.tags.forEach(tag => {
                  const tagElement = document.createElement('span');
                  tagElement.className = 'px-3 py-1 bg-ctp-sky/20 text-ctp-sky rounded-full text-xs';
                  tagElement.textContent = tag;
                  modalTagsEl.appendChild(tagElement);
              });
          } else {
              console.log("MODAL SCRIPTS: No tags for this project.");
          }
  
          modalGithubEl.href = project.github || '#';
          modalLiveEl.href = project.live || '#';
  
          modalGithubEl.style.display = project.github ? 'inline-flex' : 'none';
          modalLiveEl.style.display = project.live ? 'inline-flex' : 'none';
          console.log("MODAL SCRIPTS: GitHub link display:", modalGithubEl.style.display, " Live link display:", modalLiveEl.style.display);
  
          projectModal.classList.remove('hidden');
          projectModal.classList.add('flex');
          document.body.style.overflow = 'hidden';
          console.log("MODAL SCRIPTS: Modal should be visible now.");
      } else {
          console.error("MODAL SCRIPTS: ERROR - Project data for ID '"+ projectId +"' found BUT some modal HTML elements are missing OR project object is incomplete.");
          console.error("MODAL SCRIPTS: Details - project:", project, "modalTitleEl:", modalTitleEl, "modalContentEl:", modalContentEl, "modalTagsEl:", modalTagsEl, "modalGithubEl:", modalGithubEl, "modalLiveEl:", modalLiveEl);
          projectModal.classList.add('hidden');
      }
  }
  
  function closeProjectModal() {
      console.log("MODAL SCRIPTS: closeProjectModal function CALLED.");
      if (projectModal) {
          projectModal.classList.add('hidden');
          projectModal.classList.remove('flex');
          document.body.style.overflow = 'auto';
      }
  }
  
  if (projectModal) {
      projectModal.addEventListener('click', (e) => {
          if (e.target.id === 'projectModal') {
              closeProjectModal();
          }
      });
  }
  
  document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && projectModal && !projectModal.classList.contains('hidden')) {
          closeProjectModal();
      }
  });
  
  console.log("MODAL SCRIPTS: Event listeners for close attached.");
  </script>