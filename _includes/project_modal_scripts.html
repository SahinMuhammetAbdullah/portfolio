<script>
  // Proje verilerini Jekyll'dan alıp JS'e aktarmak için
  const allProjectsData = {
    {% assign s_global_js = site.data.strings %}
    tr: {
      projects: [
        {% assign base_project_path_tr = '_projects/tr/' %}
        {% assign projects_tr_modal_js = site.projects | where_exp: "item", "item.path contains base_project_path_tr" %}
        {% for p_tr_modal_js in projects_tr_modal_js %}
        {
          id: "{{ p_tr_modal_js.id | slugify }}",
          title: "{{ p_tr_modal_js.title | escape_once }}",
          content: {{ p_tr_modal_js.content | strip_newlines | jsonify }},
          tags: {{ p_tr_modal_js.tags | jsonify }},
          github: "{{ p_tr_modal_js.github_url }}",
          live: "{{ p_tr_modal_js.live_url }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    },
    en: {
      projects: [
        {% assign base_project_path_en = '_projects/en/' %}
        {% assign projects_en_modal_js = site.projects | where_exp: "item", "item.path contains base_project_path_en" %}
        {% for p_en_modal_js in projects_en_modal_js %}
        {
          id: "{{ p_en_modal_js.id | slugify }}",
          title: "{{ p_en_modal_js.title | escape_once }}",
          content: {{ p_en_modal_js.content | strip_newlines | jsonify }},
          tags: {{ p_en_modal_js.tags | jsonify }},
          github: "{{ p_en_modal_js.github_url }}",
          live: "{{ p_en_modal_js.live_url }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }
  };
  
  console.log("MODAL SCRIPTS: allProjectsData object initialized:", JSON.parse(JSON.stringify(allProjectsData)));
  
  const modalContentEl = document.getElementById('modalContent');
  const modalTagsEl = document.getElementById('modalTags');
  const modalGithubEl = document.getElementById('modalGithub');
  const modalLiveEl = document.getElementById('modalLive');
  const projectModal = document.getElementById('projectModal');
  const projectModalContentContainer = document.getElementById('projectModalContentContainer'); // İç container'ı da seçelim
  const modalTitleEl = document.getElementById('modalTitle');

  console.log("MODAL SCRIPTS: Modal HTML elements obtained:",
      { projectModal, modalTitleEl, modalContentEl, modalTagsEl, modalGithubEl, modalLiveEl }
  );
  
  function openProjectModal(projectId, lang) {
    // ... (proje bulma ve veri doldurma mantığı aynı kalacak) ...

    if (project && modalTitleEl && modalContentEl /* && diğer kontroller */) {
        // ... (Veri doldurma kısmı aynı)
        modalTitleEl.textContent = project.title || "Title Not Available";
        modalContentEl.innerHTML = project.content || "<p>Content Not Available.</p>";
        // ... (etiketler ve linkler aynı)

        // Modal'ı görünür yapma ve animasyonu başlatma
        if (projectModal && projectModalContentContainer) {
            projectModal.classList.remove('opacity-0', 'pointer-events-none'); // Şeffaflığı kaldır, tıklanabilir yap
            projectModalContentContainer.classList.remove('scale-95'); // Ölçeği normale getir
            projectModal.classList.add('opacity-100'); // Tamamen görünür yap (transition için)
            projectModalContentContainer.classList.add('scale-100'); // Tam ölçek (transition için)

            document.body.style.overflow = 'hidden';
            console.log("MODAL SCRIPTS: Modal should be visible and animated now.");
        }
    } else {
        // ... (hata loglama kısmı aynı)
        if (projectModal) {
             projectModal.classList.add('opacity-0', 'pointer-events-none');
             if(projectModalContentContainer) projectModalContentContainer.classList.add('scale-95');
        }
    }
}

function closeProjectModal() {
    console.log("MODAL SCRIPTS: closeProjectModal function CALLED.");
    if (projectModal && projectModalContentContainer) {
        projectModal.classList.add('opacity-0'); // Şeffaflaştır
        projectModalContentContainer.classList.add('scale-95'); // Küçült

        // Transition bittikten sonra pointer-events'i ayarla ve body scroll'u aç
        // setTimeout süresi Tailwind'deki duration-300 ile eşleşmeli (300ms)
        setTimeout(() => {
            projectModal.classList.add('pointer-events-none');
            // Eğer modal tamamen gizlenmiyorsa (sadece opacity ile oynuyorsak)
            // ve hala DOM'da flex ise, display none yapabiliriz.
            // Ama sadece opacity ve pointer-events ile de yönetilebilir.
            // projectModal.classList.remove('flex'); // Eğer display'i de yönetmek isterseniz
            // projectModal.classList.add('hidden'); // Veya tamamen gizlemek için
            document.body.style.overflow = 'auto';
        }, 300); // Tailwind transition süresiyle eşleşmeli
    }
}
  
  if (projectModal) {
      projectModal.addEventListener('click', (e) => {
          if (e.target.id === 'projectModal') {
              closeProjectModal();
          }
      });
  }
  
  document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && projectModal && !projectModal.classList.contains('hidden')) {
          closeProjectModal();
      }
  });
  
  console.log("MODAL SCRIPTS: Event listeners for close attached.");
  </script>